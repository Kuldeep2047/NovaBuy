<% layout('layouts/boilerplate') %>
<%- include('../partials/navbar') %>
<%- include('../partials/flash') %>

<div class="container py-5">
  <div class="row g-4">
    <% for(let item of products){ %>
      <div class="col-sm-6 col-lg-4">
        <!-- Card -->
        <div class="card h-100 border-0 shadow-lg rounded-4 overflow-hidden">
          
          <!-- Product Image -->
          <div class="product-img-wrapper">
            <img src="<%= item.img %>" alt="<%= item.name %>" class="product-img">
            <!-- Price Badge -->
            <span class="badge bg-success position-absolute top-0 end-0 m-3 px-3 py-2 rounded-pill shadow-sm">
              â‚¹ <%= item.price %>
            </span>
          </div>

          <!-- Card Body -->
          <div class="card-body d-flex flex-column p-4 bg-white">
            <!-- Product Name -->
            <h5 class="card-title fw-bold text-dark mb-2 text-truncate">
              <i class="fa-solid fa-box text-primary me-1"></i> <%= item.name %>
            </h5>

            <!-- Description -->
            <p class="card-text text-muted small flex-grow-1">
              <%= item.desc %>
            </p>

            <!-- Actions -->
            <div class="d-flex justify-content-between align-items-center mt-3">
              <a href="/products/<%= item._id %>" 
                 class="btn btn-sm btn-primary rounded-pill px-4 shadow-sm">
                <i class="fa-solid fa-eye"></i> Show
              </a>
              
              <% if(currentUser && currentUser.role === 'seller'){ %>
                <form class="d-inline-block" action="/products/<%= item._id %>?_method=DELETE" method="POST">
                  <button class="btn btn-sm btn-outline-danger rounded-pill px-4 shadow-sm">
                    <i class="fa-solid fa-trash"></i> Delete
                  </button>
                </form>
              <% } %>
            </div>
          </div>
        </div>
      </div>
    <% } %>
  </div>
</div>

<!-- Styles -->
<style>
  /* Image wrapper fixed height */
  .product-img-wrapper {
    position: relative;
    width: 100%;
    height: 250px;   /* fix size for uniform cards */
    overflow: hidden;
  }

  .product-img {
    width: 100%;
    height: 100%;
    object-fit: cover;   /* image crop but perfect fit */
    transition: transform 0.3s ease;
  }

  /* Subtle hover effect */
  .card:hover .product-img {
    transform: scale(1.05); /* slight zoom for premium look */
  }

  .card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
  }
</style>

</body>
</html>

<%- include('../partials/footer') %>
